{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.InternalEvents = void 0;\n\nvar React = __importStar(require(\"react\"));\n\nvar types_1 = require(\"./types\");\n\nvar useKBar_1 = require(\"./useKBar\");\n\nvar utils_1 = require(\"./utils\");\n\nfunction InternalEvents() {\n  useToggleHandler();\n  useDocumentLock();\n  useShortcuts();\n  useFocusHandler();\n  return null;\n}\n\nexports.InternalEvents = InternalEvents;\n/**\n * `useToggleHandler` handles the keyboard events for toggling kbar.\n */\n\nfunction useToggleHandler() {\n  var _a, _b;\n\n  var _c = (0, useKBar_1.useKBar)(function (state) {\n    return {\n      visualState: state.visualState,\n      showing: state.visualState !== types_1.VisualState.hidden\n    };\n  }),\n      query = _c.query,\n      options = _c.options,\n      visualState = _c.visualState,\n      showing = _c.showing;\n\n  React.useEffect(function () {\n    function handleKeyDown(event) {\n      var _a, _b, _c, _d, _e, _f;\n\n      if ((event.metaKey || event.ctrlKey) && event.key === \"k\" && event.defaultPrevented === false) {\n        event.preventDefault();\n        query.toggle();\n\n        if (showing) {\n          (_b = (_a = options.callbacks) === null || _a === void 0 ? void 0 : _a.onClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n        } else {\n          (_d = (_c = options.callbacks) === null || _c === void 0 ? void 0 : _c.onOpen) === null || _d === void 0 ? void 0 : _d.call(_c);\n        }\n      }\n\n      if (event.key === \"Escape\") {\n        if (showing) {\n          event.stopPropagation();\n          (_f = (_e = options.callbacks) === null || _e === void 0 ? void 0 : _e.onClose) === null || _f === void 0 ? void 0 : _f.call(_e);\n        }\n\n        query.setVisualState(function (vs) {\n          if (vs === types_1.VisualState.hidden || vs === types_1.VisualState.animatingOut) {\n            return vs;\n          }\n\n          return types_1.VisualState.animatingOut;\n        });\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return function () {\n      return window.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [options.callbacks, query, showing]);\n  var timeoutRef = React.useRef();\n  var runAnimateTimer = React.useCallback(function (vs) {\n    var _a, _b;\n\n    var ms = 0;\n\n    if (vs === types_1.VisualState.animatingIn) {\n      ms = ((_a = options.animations) === null || _a === void 0 ? void 0 : _a.enterMs) || 0;\n    }\n\n    if (vs === types_1.VisualState.animatingOut) {\n      ms = ((_b = options.animations) === null || _b === void 0 ? void 0 : _b.exitMs) || 0;\n    }\n\n    clearTimeout(timeoutRef.current);\n    timeoutRef.current = setTimeout(function () {\n      var backToRoot = false; // TODO: setVisualState argument should be a function or just a VisualState value.\n\n      query.setVisualState(function () {\n        var finalVs = vs === types_1.VisualState.animatingIn ? types_1.VisualState.showing : types_1.VisualState.hidden;\n\n        if (finalVs === types_1.VisualState.hidden) {\n          backToRoot = true;\n        }\n\n        return finalVs;\n      });\n\n      if (backToRoot) {\n        query.setCurrentRootAction(null);\n      }\n    }, ms);\n  }, [(_a = options.animations) === null || _a === void 0 ? void 0 : _a.enterMs, (_b = options.animations) === null || _b === void 0 ? void 0 : _b.exitMs, query]);\n  React.useEffect(function () {\n    switch (visualState) {\n      case types_1.VisualState.animatingIn:\n      case types_1.VisualState.animatingOut:\n        runAnimateTimer(visualState);\n        break;\n    }\n  }, [runAnimateTimer, visualState]);\n}\n/**\n * `useDocumentLock` is a simple implementation for preventing the\n * underlying page content from scrolling when kbar is open.\n */\n\n\nfunction useDocumentLock() {\n  var _a = (0, useKBar_1.useKBar)(function (state) {\n    return {\n      visualState: state.visualState\n    };\n  }),\n      visualState = _a.visualState,\n      options = _a.options;\n\n  React.useEffect(function () {\n    if (visualState === types_1.VisualState.animatingIn) {\n      document.body.style.pointerEvents = \"none\";\n      document.body.style.overflow = \"hidden\";\n\n      if (!options.disableScrollbarManagement) {\n        var scrollbarWidth = (0, utils_1.getScrollbarWidth)(); // take into account the margins explicitly added by the consumer\n\n        var mr = getComputedStyle(document.body)[\"margin-right\"];\n\n        if (mr) {\n          // remove non-numeric values; px, rem, em, etc.\n          scrollbarWidth += Number(mr.replace(/\\D/g, \"\"));\n        }\n\n        document.body.style.marginRight = scrollbarWidth + \"px\";\n      }\n    } else if (visualState === types_1.VisualState.hidden) {\n      document.body.style.removeProperty(\"pointer-events\");\n      document.body.style.removeProperty(\"overflow\");\n\n      if (!options.disableScrollbarManagement) {\n        document.body.style.removeProperty(\"margin-right\");\n      }\n    }\n  }, [options.disableScrollbarManagement, visualState]);\n}\n/**\n * `useShortcuts` registers and listens to keyboard strokes and\n * performs actions for patterns that match the user defined `shortcut`.\n */\n\n\nfunction useShortcuts() {\n  var _a = (0, useKBar_1.useKBar)(function (state) {\n    return {\n      actions: state.actions\n    };\n  }),\n      actions = _a.actions,\n      query = _a.query;\n\n  React.useEffect(function () {\n    var actionsList = Object.keys(actions).map(function (key) {\n      return actions[key];\n    });\n    var buffer = [];\n    var lastKeyStrokeTime = Date.now();\n\n    function handleKeyDown(event) {\n      var _a, _b, _c;\n\n      var key = (_a = event.key) === null || _a === void 0 ? void 0 : _a.toLowerCase();\n\n      if ((0, utils_1.shouldRejectKeystrokes)() || event.metaKey || key === \"shift\") {\n        return;\n      }\n\n      var currentTime = Date.now();\n\n      if (currentTime - lastKeyStrokeTime > 400) {\n        buffer = [];\n      }\n\n      buffer.push(key);\n      lastKeyStrokeTime = currentTime;\n      var bufferString = buffer.join(\"\");\n\n      for (var _i = 0, actionsList_1 = actionsList; _i < actionsList_1.length; _i++) {\n        var action = actionsList_1[_i];\n\n        if (!action.shortcut) {\n          continue;\n        }\n\n        if (action.shortcut.join(\"\") === bufferString) {\n          event.preventDefault();\n\n          if ((_b = action.children) === null || _b === void 0 ? void 0 : _b.length) {\n            query.setCurrentRootAction(action.id);\n            query.toggle();\n          } else {\n            (_c = action.command) === null || _c === void 0 ? void 0 : _c.perform();\n          }\n\n          buffer = [];\n          break;\n        }\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return function () {\n      return window.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [actions, query]);\n}\n/**\n * `useFocusHandler` ensures that focus is set back on the element which was\n * in focus prior to kbar being triggered.\n */\n\n\nfunction useFocusHandler() {\n  var isShowing = (0, useKBar_1.useKBar)(function (state) {\n    return {\n      isShowing: state.visualState === types_1.VisualState.showing || state.visualState === types_1.VisualState.animatingIn\n    };\n  }).isShowing;\n  var activeElementRef = React.useRef(null);\n  React.useEffect(function () {\n    if (isShowing) {\n      activeElementRef.current = document.activeElement;\n      return;\n    } // This fixes an issue on Safari where closing kbar causes the entire\n    // page to scroll to the bottom. The reason this was happening was due\n    // to the search input still in focus when we removed it from the dom.\n\n\n    var currentActiveElement = document.activeElement;\n\n    if ((currentActiveElement === null || currentActiveElement === void 0 ? void 0 : currentActiveElement.tagName.toLowerCase()) === \"input\") {\n      currentActiveElement.blur();\n    }\n\n    var activeElement = activeElementRef.current;\n\n    if (activeElement) {\n      activeElement.focus();\n    }\n  }, [isShowing]);\n}","map":{"version":3,"sources":["/Users/DhritiGabani/personal-web/node_modules/kbar/lib/InternalEvents.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","prototype","hasOwnProperty","call","exports","InternalEvents","React","require","types_1","useKBar_1","utils_1","useToggleHandler","useDocumentLock","useShortcuts","useFocusHandler","_a","_b","_c","useKBar","state","visualState","showing","VisualState","hidden","query","options","useEffect","handleKeyDown","event","_d","_e","_f","metaKey","ctrlKey","key","defaultPrevented","preventDefault","toggle","callbacks","onClose","onOpen","stopPropagation","setVisualState","vs","animatingOut","window","addEventListener","removeEventListener","timeoutRef","useRef","runAnimateTimer","useCallback","ms","animatingIn","animations","enterMs","exitMs","clearTimeout","current","setTimeout","backToRoot","finalVs","setCurrentRootAction","document","body","style","pointerEvents","overflow","disableScrollbarManagement","scrollbarWidth","getScrollbarWidth","mr","getComputedStyle","Number","replace","marginRight","removeProperty","actions","actionsList","keys","map","buffer","lastKeyStrokeTime","Date","now","toLowerCase","shouldRejectKeystrokes","currentTime","push","bufferString","join","_i","actionsList_1","length","action","shortcut","children","id","command","perform","isShowing","activeElementRef","activeElement","currentActiveElement","tagName","blur","focus"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InternalEvents = void 0;\nvar React = __importStar(require(\"react\"));\nvar types_1 = require(\"./types\");\nvar useKBar_1 = require(\"./useKBar\");\nvar utils_1 = require(\"./utils\");\nfunction InternalEvents() {\n    useToggleHandler();\n    useDocumentLock();\n    useShortcuts();\n    useFocusHandler();\n    return null;\n}\nexports.InternalEvents = InternalEvents;\n/**\n * `useToggleHandler` handles the keyboard events for toggling kbar.\n */\nfunction useToggleHandler() {\n    var _a, _b;\n    var _c = (0, useKBar_1.useKBar)(function (state) { return ({\n        visualState: state.visualState,\n        showing: state.visualState !== types_1.VisualState.hidden,\n    }); }), query = _c.query, options = _c.options, visualState = _c.visualState, showing = _c.showing;\n    React.useEffect(function () {\n        function handleKeyDown(event) {\n            var _a, _b, _c, _d, _e, _f;\n            if ((event.metaKey || event.ctrlKey) &&\n                event.key === \"k\" &&\n                event.defaultPrevented === false) {\n                event.preventDefault();\n                query.toggle();\n                if (showing) {\n                    (_b = (_a = options.callbacks) === null || _a === void 0 ? void 0 : _a.onClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n                }\n                else {\n                    (_d = (_c = options.callbacks) === null || _c === void 0 ? void 0 : _c.onOpen) === null || _d === void 0 ? void 0 : _d.call(_c);\n                }\n            }\n            if (event.key === \"Escape\") {\n                if (showing) {\n                    event.stopPropagation();\n                    (_f = (_e = options.callbacks) === null || _e === void 0 ? void 0 : _e.onClose) === null || _f === void 0 ? void 0 : _f.call(_e);\n                }\n                query.setVisualState(function (vs) {\n                    if (vs === types_1.VisualState.hidden || vs === types_1.VisualState.animatingOut) {\n                        return vs;\n                    }\n                    return types_1.VisualState.animatingOut;\n                });\n            }\n        }\n        window.addEventListener(\"keydown\", handleKeyDown);\n        return function () { return window.removeEventListener(\"keydown\", handleKeyDown); };\n    }, [options.callbacks, query, showing]);\n    var timeoutRef = React.useRef();\n    var runAnimateTimer = React.useCallback(function (vs) {\n        var _a, _b;\n        var ms = 0;\n        if (vs === types_1.VisualState.animatingIn) {\n            ms = ((_a = options.animations) === null || _a === void 0 ? void 0 : _a.enterMs) || 0;\n        }\n        if (vs === types_1.VisualState.animatingOut) {\n            ms = ((_b = options.animations) === null || _b === void 0 ? void 0 : _b.exitMs) || 0;\n        }\n        clearTimeout(timeoutRef.current);\n        timeoutRef.current = setTimeout(function () {\n            var backToRoot = false;\n            // TODO: setVisualState argument should be a function or just a VisualState value.\n            query.setVisualState(function () {\n                var finalVs = vs === types_1.VisualState.animatingIn\n                    ? types_1.VisualState.showing\n                    : types_1.VisualState.hidden;\n                if (finalVs === types_1.VisualState.hidden) {\n                    backToRoot = true;\n                }\n                return finalVs;\n            });\n            if (backToRoot) {\n                query.setCurrentRootAction(null);\n            }\n        }, ms);\n    }, [(_a = options.animations) === null || _a === void 0 ? void 0 : _a.enterMs, (_b = options.animations) === null || _b === void 0 ? void 0 : _b.exitMs, query]);\n    React.useEffect(function () {\n        switch (visualState) {\n            case types_1.VisualState.animatingIn:\n            case types_1.VisualState.animatingOut:\n                runAnimateTimer(visualState);\n                break;\n        }\n    }, [runAnimateTimer, visualState]);\n}\n/**\n * `useDocumentLock` is a simple implementation for preventing the\n * underlying page content from scrolling when kbar is open.\n */\nfunction useDocumentLock() {\n    var _a = (0, useKBar_1.useKBar)(function (state) { return ({\n        visualState: state.visualState,\n    }); }), visualState = _a.visualState, options = _a.options;\n    React.useEffect(function () {\n        if (visualState === types_1.VisualState.animatingIn) {\n            document.body.style.pointerEvents = \"none\";\n            document.body.style.overflow = \"hidden\";\n            if (!options.disableScrollbarManagement) {\n                var scrollbarWidth = (0, utils_1.getScrollbarWidth)();\n                // take into account the margins explicitly added by the consumer\n                var mr = getComputedStyle(document.body)[\"margin-right\"];\n                if (mr) {\n                    // remove non-numeric values; px, rem, em, etc.\n                    scrollbarWidth += Number(mr.replace(/\\D/g, \"\"));\n                }\n                document.body.style.marginRight = scrollbarWidth + \"px\";\n            }\n        }\n        else if (visualState === types_1.VisualState.hidden) {\n            document.body.style.removeProperty(\"pointer-events\");\n            document.body.style.removeProperty(\"overflow\");\n            if (!options.disableScrollbarManagement) {\n                document.body.style.removeProperty(\"margin-right\");\n            }\n        }\n    }, [options.disableScrollbarManagement, visualState]);\n}\n/**\n * `useShortcuts` registers and listens to keyboard strokes and\n * performs actions for patterns that match the user defined `shortcut`.\n */\nfunction useShortcuts() {\n    var _a = (0, useKBar_1.useKBar)(function (state) { return ({\n        actions: state.actions,\n    }); }), actions = _a.actions, query = _a.query;\n    React.useEffect(function () {\n        var actionsList = Object.keys(actions).map(function (key) { return actions[key]; });\n        var buffer = [];\n        var lastKeyStrokeTime = Date.now();\n        function handleKeyDown(event) {\n            var _a, _b, _c;\n            var key = (_a = event.key) === null || _a === void 0 ? void 0 : _a.toLowerCase();\n            if ((0, utils_1.shouldRejectKeystrokes)() || event.metaKey || key === \"shift\") {\n                return;\n            }\n            var currentTime = Date.now();\n            if (currentTime - lastKeyStrokeTime > 400) {\n                buffer = [];\n            }\n            buffer.push(key);\n            lastKeyStrokeTime = currentTime;\n            var bufferString = buffer.join(\"\");\n            for (var _i = 0, actionsList_1 = actionsList; _i < actionsList_1.length; _i++) {\n                var action = actionsList_1[_i];\n                if (!action.shortcut) {\n                    continue;\n                }\n                if (action.shortcut.join(\"\") === bufferString) {\n                    event.preventDefault();\n                    if ((_b = action.children) === null || _b === void 0 ? void 0 : _b.length) {\n                        query.setCurrentRootAction(action.id);\n                        query.toggle();\n                    }\n                    else {\n                        (_c = action.command) === null || _c === void 0 ? void 0 : _c.perform();\n                    }\n                    buffer = [];\n                    break;\n                }\n            }\n        }\n        window.addEventListener(\"keydown\", handleKeyDown);\n        return function () { return window.removeEventListener(\"keydown\", handleKeyDown); };\n    }, [actions, query]);\n}\n/**\n * `useFocusHandler` ensures that focus is set back on the element which was\n * in focus prior to kbar being triggered.\n */\nfunction useFocusHandler() {\n    var isShowing = (0, useKBar_1.useKBar)(function (state) { return ({\n        isShowing: state.visualState === types_1.VisualState.showing ||\n            state.visualState === types_1.VisualState.animatingIn,\n    }); }).isShowing;\n    var activeElementRef = React.useRef(null);\n    React.useEffect(function () {\n        if (isShowing) {\n            activeElementRef.current = document.activeElement;\n            return;\n        }\n        // This fixes an issue on Safari where closing kbar causes the entire\n        // page to scroll to the bottom. The reason this was happening was due\n        // to the search input still in focus when we removed it from the dom.\n        var currentActiveElement = document.activeElement;\n        if ((currentActiveElement === null || currentActiveElement === void 0 ? void 0 : currentActiveElement.tagName.toLowerCase()) === \"input\") {\n            currentActiveElement.blur();\n        }\n        var activeElement = activeElementRef.current;\n        if (activeElement) {\n            activeElement.focus();\n        }\n    }, [isShowing]);\n}\n"]},"metadata":{},"sourceType":"script"}