{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.KBarAnimator = void 0;\n\nvar React = __importStar(require(\"react\"));\n\nvar types_1 = require(\"./types\");\n\nvar useKBar_1 = require(\"./useKBar\");\n\nvar utils_1 = require(\"./utils\");\n\nvar appearanceAnimationKeyframes = [{\n  opacity: 0,\n  transform: \"scale(.99)\"\n}, {\n  opacity: 1,\n  transform: \"scale(1.01)\"\n}, {\n  opacity: 1,\n  transform: \"scale(1)\"\n}];\nvar bumpAnimationKeyframes = [{\n  transform: \"scale(1)\"\n}, {\n  transform: \"scale(.98)\"\n}, {\n  transform: \"scale(1)\"\n}];\n\nvar KBarAnimator = function (_a) {\n  var _b, _c;\n\n  var children = _a.children,\n      style = _a.style,\n      className = _a.className;\n\n  var _d = (0, useKBar_1.useKBar)(function (state) {\n    return {\n      visualState: state.visualState,\n      currentRootActionId: state.currentRootActionId\n    };\n  }),\n      visualState = _d.visualState,\n      currentRootActionId = _d.currentRootActionId,\n      query = _d.query,\n      options = _d.options;\n\n  var outerRef = React.useRef(null);\n  var innerRef = React.useRef(null);\n  var enterMs = ((_b = options === null || options === void 0 ? void 0 : options.animations) === null || _b === void 0 ? void 0 : _b.enterMs) || 0;\n  var exitMs = ((_c = options === null || options === void 0 ? void 0 : options.animations) === null || _c === void 0 ? void 0 : _c.exitMs) || 0; // Show/hide animation\n\n  React.useEffect(function () {\n    if (visualState === types_1.VisualState.showing) {\n      return;\n    }\n\n    var duration = visualState === types_1.VisualState.animatingIn ? enterMs : exitMs;\n    var element = outerRef.current;\n    element === null || element === void 0 ? void 0 : element.animate(appearanceAnimationKeyframes, {\n      duration: duration,\n      easing: // TODO: expose easing in options\n      visualState === types_1.VisualState.animatingOut ? \"ease-in\" : \"ease-out\",\n      direction: visualState === types_1.VisualState.animatingOut ? \"reverse\" : \"normal\",\n      fill: \"forwards\"\n    });\n  }, [options, visualState, enterMs, exitMs]); // Height animation\n\n  var previousHeight = React.useRef();\n  React.useEffect(function () {\n    // Only animate if we're actually showing\n    if (visualState === types_1.VisualState.showing) {\n      var outer_1 = outerRef.current;\n      var inner_1 = innerRef.current;\n\n      if (!outer_1 || !inner_1) {\n        return;\n      }\n\n      var ro_1 = new ResizeObserver(function (entries) {\n        for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n          var entry = entries_1[_i];\n          var cr = entry.contentRect;\n\n          if (!previousHeight.current) {\n            previousHeight.current = cr.height;\n          }\n\n          outer_1.animate([{\n            height: previousHeight.current + \"px\"\n          }, {\n            height: cr.height + \"px\"\n          }], {\n            duration: enterMs / 2,\n            // TODO: expose configs here\n            easing: \"ease-out\",\n            fill: \"forwards\"\n          });\n          previousHeight.current = cr.height;\n        }\n      });\n      ro_1.observe(inner_1);\n      return function () {\n        ro_1.unobserve(inner_1);\n      };\n    }\n  }, [visualState, options, enterMs, exitMs]); // Bump animation between nested actions\n\n  var firstRender = React.useRef(true);\n  React.useEffect(function () {\n    if (firstRender.current) {\n      firstRender.current = false;\n      return;\n    }\n\n    var element = outerRef.current;\n\n    if (element) {\n      element.animate(bumpAnimationKeyframes, {\n        duration: enterMs,\n        easing: \"ease-out\"\n      });\n    }\n  }, [currentRootActionId, enterMs]);\n  (0, utils_1.useOuterClick)(outerRef, function () {\n    var _a, _b;\n\n    query.setVisualState(types_1.VisualState.animatingOut);\n    (_b = (_a = options.callbacks) === null || _a === void 0 ? void 0 : _a.onClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n  });\n  return React.createElement(\"div\", {\n    ref: outerRef,\n    style: __assign(__assign(__assign({}, appearanceAnimationKeyframes[0]), style), {\n      pointerEvents: \"auto\"\n    }),\n    className: className\n  }, React.createElement(\"div\", {\n    ref: innerRef\n  }, children));\n};\n\nexports.KBarAnimator = KBarAnimator;","map":{"version":3,"sources":["/Users/DhritiGabani/personal-web/node_modules/kbar/lib/KBarAnimator.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__createBinding","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","exports","KBarAnimator","React","require","types_1","useKBar_1","utils_1","appearanceAnimationKeyframes","opacity","transform","bumpAnimationKeyframes","_a","_b","_c","children","style","className","_d","useKBar","state","visualState","currentRootActionId","query","options","outerRef","useRef","innerRef","enterMs","animations","exitMs","useEffect","VisualState","showing","duration","animatingIn","element","current","animate","easing","animatingOut","direction","fill","previousHeight","outer_1","inner_1","ro_1","ResizeObserver","entries","_i","entries_1","entry","cr","contentRect","height","observe","unobserve","firstRender","useOuterClick","setVisualState","callbacks","onClose","createElement","ref","pointerEvents"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.KBarAnimator = void 0;\nvar React = __importStar(require(\"react\"));\nvar types_1 = require(\"./types\");\nvar useKBar_1 = require(\"./useKBar\");\nvar utils_1 = require(\"./utils\");\nvar appearanceAnimationKeyframes = [\n    {\n        opacity: 0,\n        transform: \"scale(.99)\",\n    },\n    { opacity: 1, transform: \"scale(1.01)\" },\n    { opacity: 1, transform: \"scale(1)\" },\n];\nvar bumpAnimationKeyframes = [\n    {\n        transform: \"scale(1)\",\n    },\n    {\n        transform: \"scale(.98)\",\n    },\n    {\n        transform: \"scale(1)\",\n    },\n];\nvar KBarAnimator = function (_a) {\n    var _b, _c;\n    var children = _a.children, style = _a.style, className = _a.className;\n    var _d = (0, useKBar_1.useKBar)(function (state) { return ({\n        visualState: state.visualState,\n        currentRootActionId: state.currentRootActionId,\n    }); }), visualState = _d.visualState, currentRootActionId = _d.currentRootActionId, query = _d.query, options = _d.options;\n    var outerRef = React.useRef(null);\n    var innerRef = React.useRef(null);\n    var enterMs = ((_b = options === null || options === void 0 ? void 0 : options.animations) === null || _b === void 0 ? void 0 : _b.enterMs) || 0;\n    var exitMs = ((_c = options === null || options === void 0 ? void 0 : options.animations) === null || _c === void 0 ? void 0 : _c.exitMs) || 0;\n    // Show/hide animation\n    React.useEffect(function () {\n        if (visualState === types_1.VisualState.showing) {\n            return;\n        }\n        var duration = visualState === types_1.VisualState.animatingIn ? enterMs : exitMs;\n        var element = outerRef.current;\n        element === null || element === void 0 ? void 0 : element.animate(appearanceAnimationKeyframes, {\n            duration: duration,\n            easing: \n            // TODO: expose easing in options\n            visualState === types_1.VisualState.animatingOut ? \"ease-in\" : \"ease-out\",\n            direction: visualState === types_1.VisualState.animatingOut ? \"reverse\" : \"normal\",\n            fill: \"forwards\",\n        });\n    }, [options, visualState, enterMs, exitMs]);\n    // Height animation\n    var previousHeight = React.useRef();\n    React.useEffect(function () {\n        // Only animate if we're actually showing\n        if (visualState === types_1.VisualState.showing) {\n            var outer_1 = outerRef.current;\n            var inner_1 = innerRef.current;\n            if (!outer_1 || !inner_1) {\n                return;\n            }\n            var ro_1 = new ResizeObserver(function (entries) {\n                for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\n                    var entry = entries_1[_i];\n                    var cr = entry.contentRect;\n                    if (!previousHeight.current) {\n                        previousHeight.current = cr.height;\n                    }\n                    outer_1.animate([\n                        {\n                            height: previousHeight.current + \"px\",\n                        },\n                        {\n                            height: cr.height + \"px\",\n                        },\n                    ], {\n                        duration: enterMs / 2,\n                        // TODO: expose configs here\n                        easing: \"ease-out\",\n                        fill: \"forwards\",\n                    });\n                    previousHeight.current = cr.height;\n                }\n            });\n            ro_1.observe(inner_1);\n            return function () {\n                ro_1.unobserve(inner_1);\n            };\n        }\n    }, [visualState, options, enterMs, exitMs]);\n    // Bump animation between nested actions\n    var firstRender = React.useRef(true);\n    React.useEffect(function () {\n        if (firstRender.current) {\n            firstRender.current = false;\n            return;\n        }\n        var element = outerRef.current;\n        if (element) {\n            element.animate(bumpAnimationKeyframes, {\n                duration: enterMs,\n                easing: \"ease-out\",\n            });\n        }\n    }, [currentRootActionId, enterMs]);\n    (0, utils_1.useOuterClick)(outerRef, function () {\n        var _a, _b;\n        query.setVisualState(types_1.VisualState.animatingOut);\n        (_b = (_a = options.callbacks) === null || _a === void 0 ? void 0 : _a.onClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    });\n    return (React.createElement(\"div\", { ref: outerRef, style: __assign(__assign(__assign({}, appearanceAnimationKeyframes[0]), style), { pointerEvents: \"auto\" }), className: className },\n        React.createElement(\"div\", { ref: innerRef }, children)));\n};\nexports.KBarAnimator = KBarAnimator;\n"]},"metadata":{},"sourceType":"script"}